"use strict";(self.webpackChunkmantis_material_react=self.webpackChunkmantis_material_react||[]).push([[4892],{82548:(t,e,n)=>{n.r(e),n.d(e,{default:()=>y});var l=n(9950),i=n(99810),a=n(49029),r=n(47113),o=n(48513),s=n(82215),c=n(29352),h=n.n(c);n(55392);const d=n.p+"static/media/point.2b3c9f101e26009e69d6.png";var p=n(60899),g=n(8145),u=n(18216),m=n(44414);const x=[{id:1,start:{lat:10.717388,lng:106.600147},end:{lat:9.177064,lng:105.150208},departureTime:"10:00",nameTrip:"H\u1ed3 Ch\xed Minh -> C\xe0 Mau"},{id:2,start:{lat:10.544137,lng:106.411715},end:{lat:9.177064,lng:105.150208},departureTime:"11:00",nameTrip:"Long An -> C\xe0 Mau"},{id:3,start:{lat:11.313937,lng:106.096367},end:{lat:9.315392,lng:105.719191},departureTime:"10:00",nameTrip:"T\xe2y Ninh -> B\u1ea1c Li\xeau"}],y=()=>{const[t,e]=(0,l.useState)({lat:"",lng:""}),[n,c]=(0,l.useState)({lat:"",lng:""}),[y,j]=(0,l.useState)([]),f=new L.Icon({iconUrl:d,iconSize:[30,30],iconAnchor:[15,30],popupAnchor:[0,-30]}),[b,v]=(0,l.useState)(null),T=(t,e)=>fetch(`https://graphhopper.com/api/1/geocode?reverse=true&point=${t},${e}&key=f8620a35-ab3c-438a-a573-c38120f57482&locale=vi`).then((t=>t.json())).then((t=>{if(t&&t.hits&&t.hits.length>0){const e=t.hits[0];return`${e.name||""}, ${e.state||""}`}return console.error("Kh\xf4ng t\xecm th\u1ea5y \u0111\u1ecba ch\u1ec9 cho t\u1ecda \u0111\u1ed9 n\xe0y"),"Kh\xf4ng x\xe1c \u0111\u1ecbnh"})).catch((t=>(console.error("L\u1ed7i khi l\u1ea5y th\xf4ng tin v\u1ecb tr\xed:",t),"Kh\xf4ng x\xe1c \u0111\u1ecbnh"))),k=(t,e)=>{const n=`https://graphhopper.com/api/1/route?point=${t.lat},${t.lng}&point=${e.lat},${e.lng}&vehicle=car&key=f8620a35-ab3c-438a-a573-c38120f57482&locale=vn`;return fetch(n).then((t=>t.json())).then((t=>{if(t.paths&&t.paths.length>0){const e=t.paths[0].points;return{polyline:h().decode(e).map((t=>[t[0],t[1]])),time:t.paths[0].time/1e3/60,distance:t.paths[0].distance/1e3,paths:t.paths}}return console.error("Kh\xf4ng c\xf3 tuy\u1ebfn \u0111\u01b0\u1eddng n\xe0o \u0111\u01b0\u1ee3c t\xecm th\u1ea5y"),null})).catch((t=>(console.error("L\u1ed7i khi l\u1ea5y tuy\u1ebfn \u0111\u01b0\u1eddng:",t),null)))},w=(t,e)=>e.some((e=>Math.sqrt(Math.pow(e[0]-t.lat,2)+Math.pow(e[1]-t.lng,2))<.001));return(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"150vh",width:"70vw",overflow:"hidden",border:"2px solid #ddd",margin:"0 auto",flexDirection:"column"},children:[(0,m.jsx)("form",{onSubmit:async e=>{e.preventDefault();const l={start:{lat:parseFloat(t.lat),lng:parseFloat(t.lng)},end:{lat:parseFloat(n.lat),lng:parseFloat(n.lng)}},i=await T(l.start.lat,l.start.lng),a=await T(l.end.lat,l.end.lng);console.log("V\u1ecb tr\xed b\u1eaft \u0111\u1ea7u:",i),console.log("V\u1ecb tr\xed k\u1ebft th\xfac:",a);const r=(await Promise.all(x.map((async t=>{const e=await k(l.start,t.start),n=await k(t.end,l.end);if(e&&n){let i=e.time+n.time,a=e.distance+n.distance;return w(l.start,e.polyline)&&w(l.end,n.polyline)&&(i=e.time+n.time,a=e.distance+n.distance),{trip:t,routeToTrip:e,routeFromTrip:n,totalTime:i,time:i,distance:a}}return null})))).filter(Boolean).sort(((t,e)=>t.time-e.time));j(r);const o=r[0];if(o){const{routeToTrip:t,routeFromTrip:e}=o;console.log(t.paths[0]),t.paths[0].instructions&&t.paths[0].instructions.forEach(((t,e)=>{console.log(`B\u01b0\u1edbc ${e+1} (T\u1eeb kh\xe1ch \u0111\u1ebfn chuy\u1ebfn \u0111i): ${t.text}, kho\u1ea3ng c\xe1ch: ${t.distance} km`)})),e.paths[0].instructions&&e.paths[0].instructions.forEach(((t,e)=>{console.log(`B\u01b0\u1edbc ${e+1} (T\u1eeb chuy\u1ebfn \u0111i \u0111\u1ebfn kh\xe1ch): ${t.text}, kho\u1ea3ng c\xe1ch: ${t.distance} km`)}))}},style:{margin:"20px auto",maxWidth:"500px",padding:"20px",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:(0,m.jsxs)(p.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,m.jsx)(p.Ay,{item:!0,xs:6,children:(0,m.jsx)(g.A,{label:"Start Latitude",type:"number",fullWidth:!0,value:t.lat,onChange:n=>e({...t,lat:n.target.value}),required:!0})}),(0,m.jsx)(p.Ay,{item:!0,xs:6,children:(0,m.jsx)(g.A,{label:"Start Longitude",type:"number",fullWidth:!0,value:t.lng,onChange:n=>e({...t,lng:n.target.value}),required:!0})}),(0,m.jsx)(p.Ay,{item:!0,xs:6,children:(0,m.jsx)(g.A,{label:"End Latitude",type:"number",fullWidth:!0,value:n.lat,onChange:t=>c({...n,lat:t.target.value}),required:!0})}),(0,m.jsx)(p.Ay,{item:!0,xs:6,children:(0,m.jsx)(g.A,{label:"End Longitude",type:"number",fullWidth:!0,value:n.lng,onChange:t=>c({...n,lng:t.target.value}),required:!0})}),(0,m.jsxs)(p.Ay,{item:!0,xs:12,children:[(0,m.jsx)(u.A,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"Submit"}),(0,m.jsx)(u.A,{onClick:()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((t=>{e({lat:t.coords.latitude,lng:t.coords.longitude}),v({lat:t.coords.latitude,lng:t.coords.longitude})}),(t=>{console.error("Error getting location:",t)})):console.error("Geolocation is not supported by this browser.")},color:"primary",children:"Find My Location"})]})]})}),y.length>0&&(0,m.jsxs)("div",{children:[(0,m.jsx)("h3",{children:"Chuy\u1ebfn \u0111i s\u1eafp x\u1ebfp theo th\u1eddi gian:"}),y.map(((t,e)=>(0,m.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,m.jsxs)("p",{children:[(0,m.jsxs)("strong",{children:["Chuy\u1ebfn ",t.trip.id]}),": ",t.trip.start.lat,",",t.trip.start.lng," \u2192 ",t.trip.end.lat,",",t.trip.end.lng]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"\u0110\u1ecba \u0111i\u1ec3m:"})," ",t.trip.nameTrip]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"T\u1ed5ng th\u1eddi gian:"})," ",t.time.toFixed(2)," ph\xfat"]}),(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"T\u1ed5ng kho\u1ea3ng c\xe1ch:"})," ",t.distance.toFixed(2)," km"]})]},e)))]}),(0,m.jsxs)(i.W,{center:[10.128553,106.470299],zoom:13,style:{width:"100%",height:"100%"},scrollWheelZoom:!0,children:[(0,m.jsx)(a.e,{url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}&scale=2",attribution:"Map data \xa9 <a href='https://www.google.com/intl/en-US_US/help/terms_maps.html'>Google</a>"}),".",b&&(0,m.jsx)(r.p,{position:[b.lat,b.lng],icon:f,children:(0,m.jsxs)(o.z,{children:["Your Location: ",b.lat,", ",b.lng]})}),t.lat&&t.lng&&(0,m.jsx)(r.p,{position:[t.lat,t.lng],icon:f,children:(0,m.jsxs)(o.z,{children:["Start: ",t.lat,", ",t.lng]})}),n.lat&&n.lng&&(0,m.jsx)(r.p,{position:[n.lat,n.lng],icon:f,children:(0,m.jsxs)(o.z,{children:["End: ",n.lat,", ",n.lng]})}),y.length>0&&y.map(((t,e)=>(0,m.jsx)(s.R,{positions:t.routeToTrip.polyline.concat(t.routeFromTrip.polyline),color:"blue"},e)))]})]})}}}]);