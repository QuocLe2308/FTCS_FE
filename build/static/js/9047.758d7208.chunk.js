"use strict";(self.webpackChunkmantis_material_react=self.webpackChunkmantis_material_react||[]).push([[9047],{9047:(e,i,n)=>{n.r(i),n.d(i,{default:()=>E});var s=n(28429),r=n(14857),t=n(60899),d=n(93230),o=n(19647),l=n(25979),c=n(8145),a=n(70006),h=n(16491),x=n(23266),u=n(24516),m=n(82053),j=n(18216),A=n(1320),v=n(15769),p=n(69780),y=n(9213),g=n(68605),f=n(34075),I=n(74745),b=n(6266),_=n(81831),w=n(31655),C=n(34102),q=n(29714),M=n(67956),k=n(43974),N=n(45818),S=n(44967),D=n(94826),P=n(1587),O=n(29735),F=n(91290),B=n(51707),T=n(16243),$=n(56921),z=n(91807),V=n(65733),H=n(24513),L=n(8750),R=n(44414);const W=q.Ik({date:q.p6().required("Invoice date is required"),due_date:q.p6().when("date",((e,i)=>e&&i.min(e,"Due date can't be before invoice date"))).nullable().required("Due date is required"),customerInfo:q.Ik({name:q.Yj().required("Invoice receiver information is required")}).required("Invoice receiver information is required"),status:q.Yj().required("Status selection is required"),invoice_detail:q.YO().required("Invoice details is required").of(q.Ik().shape({name:q.Yj().required("Product name is required")})).min(1,"Invoice must have at least 1 items")}),Y=e=>{let{lists:i,invoiceMaster:n}=e;const q=(0,r.A)(),D=(0,s.Zp)();return(0,R.jsx)(N.l1,{initialValues:{id:120,invoice_id:Date.now(),status:"",date:new Date,due_date:null,cashierInfo:{name:"Belle J. Richter",address:"1300 Cooks Mine, NM 87829",phone:"305-829-7809",email:"belljrc23@gmail.com"},customerInfo:{address:"",email:"",name:"",phone:""},invoice_detail:[{id:(0,M.A)(),name:"",description:"",qty:1,price:"1.00"}],discount:0,tax:0,notes:""},validationSchema:W,onSubmit:e=>{(e=>{var n,s,r;const t={id:Number((0,$.A)(i.length)),invoice_id:Number(e.invoice_id),customer_name:null===(n=e.cashierInfo)||void 0===n?void 0:n.name,email:null===(s=e.cashierInfo)||void 0===s?void 0:s.email,avatar:Number(Math.round(10*Math.random())),discount:Number(e.discount),tax:Number(e.tax),date:(0,k.A)(e.date,"MM/dd/yyyy"),due_date:(0,k.A)(e.due_date,"MM/dd/yyyy"),quantity:Number(null===(r=e.invoice_detail)||void 0===r?void 0:r.reduce(((e,i)=>e+i.qty),0)),status:e.status,cashierInfo:e.cashierInfo,customerInfo:e.customerInfo,invoice_detail:e.invoice_detail,notes:e.notes};(0,V.lz)(t),(0,z.aN)({open:!0,message:"Invoice Added successfully",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"alert",alert:{color:"success"}}),D("/apps/invoice/list")})(e)},children:e=>{var i,s,r,k,D,P,T,$,z;let{handleBlur:W,errors:Y,handleChange:E,handleSubmit:U,values:Z,isValid:G,setFieldValue:J,touched:Q}=e;const K=null===Z||void 0===Z?void 0:Z.invoice_detail.reduce(((e,i)=>i.name.trim().length>0?e+Number(i.price*Math.floor(i.qty)):e),0),X=Z.tax*K/100,ee=Z.discount*K/100,ie=K-ee+X;return(0,R.jsx)(N.lV,{onSubmit:U,children:(0,R.jsxs)(t.Ay,{container:!0,spacing:2,children:[(0,R.jsx)(t.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,R.jsxs)(d.A,{spacing:1,children:[(0,R.jsx)(o.A,{children:"Invoice Id"}),(0,R.jsx)(l.A,{sx:{width:"100%"},children:(0,R.jsx)(c.A,{required:!0,disabled:!0,type:"number",name:"invoice_id",id:"invoice_id",value:Z.invoice_id,onChange:E})})]})}),(0,R.jsxs)(t.Ay,{item:!0,xs:12,sm:6,md:3,children:[(0,R.jsxs)(d.A,{spacing:1,children:[(0,R.jsx)(o.A,{children:"Status"}),(0,R.jsx)(l.A,{sx:{width:"100%"},children:(0,R.jsxs)(a.A,{value:Z.status,displayEmpty:!0,name:"status",renderValue:e=>0===e.length?(0,R.jsx)(h.A,{sx:{color:"secondary.400"},children:"Select status"}):e,onChange:E,error:Boolean(Y.status&&Q.status),children:[(0,R.jsx)(x.A,{disabled:!0,value:"",children:"Select status"}),(0,R.jsx)(x.A,{value:"Paid",children:"Paid"}),(0,R.jsx)(x.A,{value:"Unpaid",children:"Unpaid"}),(0,R.jsx)(x.A,{value:"Cancelled",children:"Cancelled"})]})})]}),Q.status&&Y.status&&(0,R.jsx)(u.A,{error:!0,children:Y.status})]}),(0,R.jsxs)(t.Ay,{item:!0,xs:12,sm:6,md:3,children:[(0,R.jsxs)(d.A,{spacing:1,children:[(0,R.jsx)(o.A,{children:"Date"}),(0,R.jsx)(l.A,{sx:{width:"100%"},error:Boolean(Q.date&&Y.date),children:(0,R.jsx)(_.$,{dateAdapter:C.h,children:(0,R.jsx)(w.l,{format:"dd/MM/yyyy",value:Z.date,onChange:e=>J("date",e)})})})]}),Q.date&&Y.date&&(0,R.jsx)(u.A,{error:!0,children:Y.date})]}),(0,R.jsxs)(t.Ay,{item:!0,xs:12,sm:6,md:3,children:[(0,R.jsxs)(d.A,{spacing:1,children:[(0,R.jsx)(o.A,{children:"Due Date"}),(0,R.jsx)(l.A,{sx:{width:"100%"},error:Boolean(Q.due_date&&Y.due_date),children:(0,R.jsx)(_.$,{dateAdapter:C.h,children:(0,R.jsx)(w.l,{format:"dd/MM/yyyy",value:Z.due_date,onChange:e=>J("due_date",e)})})})]}),Q.due_date&&Y.due_date&&(0,R.jsx)(u.A,{error:!0,children:Y.due_date})]}),(0,R.jsx)(t.Ay,{item:!0,xs:12,sm:6,children:(0,R.jsx)(S.A,{sx:{minHeight:168},children:(0,R.jsxs)(t.Ay,{container:!0,spacing:2,children:[(0,R.jsx)(t.Ay,{item:!0,xs:12,sm:8,children:(0,R.jsxs)(d.A,{spacing:2,children:[(0,R.jsx)(m.A,{variant:"h5",children:"From:"}),(0,R.jsxs)(d.A,{sx:{width:"100%"},children:[(0,R.jsx)(m.A,{variant:"subtitle1",children:null===Z||void 0===Z||null===(i=Z.cashierInfo)||void 0===i?void 0:i.name}),(0,R.jsx)(m.A,{color:"secondary",children:null===Z||void 0===Z||null===(s=Z.cashierInfo)||void 0===s?void 0:s.address}),(0,R.jsx)(m.A,{color:"secondary",children:null===Z||void 0===Z||null===(r=Z.cashierInfo)||void 0===r?void 0:r.phone}),(0,R.jsx)(m.A,{color:"secondary",children:null===Z||void 0===Z||null===(k=Z.cashierInfo)||void 0===k?void 0:k.email})]})]})}),(0,R.jsx)(t.Ay,{item:!0,xs:12,sm:4,children:(0,R.jsxs)(h.A,{textAlign:{xs:"left",sm:"right"},color:"grey.200",children:[(0,R.jsx)(j.A,{variant:"outlined",startIcon:(0,R.jsx)(H.A,{}),color:"secondary",onClick:()=>(0,V.tv)(!0),size:"small",children:"Change"}),(0,R.jsx)(F.A,{open:n.open,setOpen:e=>(0,V.tv)(e),handlerAddress:e=>J("cashierInfo",e)})]})})]})})}),(0,R.jsxs)(t.Ay,{item:!0,xs:12,sm:6,children:[(0,R.jsx)(S.A,{sx:{minHeight:168},children:(0,R.jsxs)(t.Ay,{container:!0,spacing:2,children:[(0,R.jsx)(t.Ay,{item:!0,xs:12,sm:8,children:(0,R.jsxs)(d.A,{spacing:2,children:[(0,R.jsx)(m.A,{variant:"h5",children:"To:"}),(0,R.jsxs)(d.A,{sx:{width:"100%"},children:[(0,R.jsx)(m.A,{variant:"subtitle1",children:null===Z||void 0===Z||null===(D=Z.customerInfo)||void 0===D?void 0:D.name}),(0,R.jsx)(m.A,{color:"secondary",children:null===Z||void 0===Z||null===(P=Z.customerInfo)||void 0===P?void 0:P.address}),(0,R.jsx)(m.A,{color:"secondary",children:null===Z||void 0===Z||null===(T=Z.customerInfo)||void 0===T?void 0:T.phone}),(0,R.jsx)(m.A,{color:"secondary",children:null===Z||void 0===Z||null===($=Z.customerInfo)||void 0===$?void 0:$.email})]})]})}),(0,R.jsx)(t.Ay,{item:!0,xs:12,sm:4,children:(0,R.jsxs)(h.A,{textAlign:"right",color:"grey.200",children:[(0,R.jsx)(j.A,{size:"small",startIcon:(0,R.jsx)(L.A,{}),color:"secondary",variant:"outlined",onClick:()=>(0,V.m$)(!0),children:"Add"}),(0,R.jsx)(F.A,{open:n.isCustomerOpen,setOpen:e=>(0,V.m$)(e),handlerAddress:e=>J("customerInfo",e)})]})})]})}),Q.customerInfo&&Y.customerInfo&&(0,R.jsx)(u.A,{error:!0,children:null===Y||void 0===Y||null===(z=Y.customerInfo)||void 0===z?void 0:z.name})]}),(0,R.jsx)(t.Ay,{item:!0,xs:12,children:(0,R.jsx)(m.A,{variant:"h5",children:"Detail"})}),(0,R.jsx)(t.Ay,{item:!0,xs:12,children:(0,R.jsx)(N.ED,{name:"invoice_detail",render:e=>{var i,s,r,l,a,x;let{remove:b,push:_}=e;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(A.A,{children:(0,R.jsxs)(v.A,{sx:{minWidth:650},children:[(0,R.jsx)(p.A,{children:(0,R.jsxs)(y.A,{children:[(0,R.jsx)(g.A,{children:"#"}),(0,R.jsx)(g.A,{children:"Name"}),(0,R.jsx)(g.A,{children:"Description"}),(0,R.jsx)(g.A,{children:"Qty"}),(0,R.jsx)(g.A,{children:"Price"}),(0,R.jsx)(g.A,{align:"right",children:"Amount"}),(0,R.jsx)(g.A,{align:"center",children:"Action"})]})}),(0,R.jsx)(f.A,{children:null===(i=Z.invoice_detail)||void 0===i?void 0:i.map(((e,i)=>(0,R.jsxs)(y.A,{children:[(0,R.jsx)(g.A,{children:Z.invoice_detail.indexOf(e)+1}),(0,R.jsx)(O.A,{id:e.id,index:i,name:e.name,description:e.description,qty:e.qty,price:e.price,onDeleteItem:e=>b(e),onEditItem:E,Blur:W,errors:Y,touched:Q},e.id)]},e.id)))})]})}),(0,R.jsx)(I.A,{}),Q.invoice_detail&&Y.invoice_detail&&!Array.isArray(null===Y||void 0===Y?void 0:Y.invoice_detail)&&(0,R.jsx)(d.A,{direction:"row",justifyContent:"center",sx:{p:1.5},children:(0,R.jsx)(u.A,{error:!0,children:Y.invoice_detail})}),(0,R.jsxs)(t.Ay,{container:!0,justifyContent:"space-between",children:[(0,R.jsx)(t.Ay,{item:!0,xs:12,md:8,children:(0,R.jsx)(h.A,{sx:{pt:2.5,pr:2.5,pb:2.5,pl:0},children:(0,R.jsx)(j.A,{color:"primary",startIcon:(0,R.jsx)(L.A,{}),onClick:()=>_({id:(0,M.A)(),name:"",description:"",qty:1,price:"1.00"}),variant:"dashed",sx:{bgcolor:"transparent !important"},children:"Add Item"})})}),(0,R.jsxs)(t.Ay,{item:!0,xs:12,md:4,children:[(0,R.jsxs)(t.Ay,{container:!0,justifyContent:"space-between",spacing:2,sx:{pt:2.5,pb:2.5},children:[(0,R.jsx)(t.Ay,{item:!0,xs:6,children:(0,R.jsxs)(d.A,{spacing:1,children:[(0,R.jsx)(o.A,{children:"Discount(%)"}),(0,R.jsx)(c.A,{type:"number",fullWidth:!0,name:"discount",id:"discount",placeholder:"0.0",value:Z.discount,onChange:E,inputProps:{min:0}})]})}),(0,R.jsx)(t.Ay,{item:!0,xs:6,children:(0,R.jsxs)(d.A,{spacing:1,children:[(0,R.jsx)(o.A,{children:"Tax(%)"}),(0,R.jsx)(c.A,{type:"number",fullWidth:!0,name:"tax",id:"tax",placeholder:"0.0",value:Z.tax,onChange:E,inputProps:{min:0}})]})})]}),(0,R.jsx)(t.Ay,{item:!0,xs:12,children:(0,R.jsxs)(d.A,{spacing:2,children:[(0,R.jsxs)(d.A,{direction:"row",justifyContent:"space-between",children:[(0,R.jsx)(m.A,{color:q.palette.grey[500],children:"Sub Total:"}),(0,R.jsx)(m.A,{children:(null===(s=n.country)||void 0===s?void 0:s.prefix)+""+K.toFixed(2)})]}),(0,R.jsxs)(d.A,{direction:"row",justifyContent:"space-between",children:[(0,R.jsx)(m.A,{color:q.palette.grey[500],children:"Discount:"}),(0,R.jsx)(m.A,{variant:"h6",color:q.palette.success.main,children:(null===(r=n.country)||void 0===r?void 0:r.prefix)+""+ee.toFixed(2)})]}),(0,R.jsxs)(d.A,{direction:"row",justifyContent:"space-between",children:[(0,R.jsx)(m.A,{color:q.palette.grey[500],children:"Tax:"}),(0,R.jsx)(m.A,{children:(null===(l=n.country)||void 0===l?void 0:l.prefix)+""+X.toFixed(2)})]}),(0,R.jsxs)(d.A,{direction:"row",justifyContent:"space-between",children:[(0,R.jsx)(m.A,{variant:"subtitle1",children:"Grand Total:"}),(0,R.jsx)(m.A,{variant:"subtitle1",children:ie%1===0?(null===(a=n.country)||void 0===a?void 0:a.prefix)+""+ie:(null===(x=n.country)||void 0===x?void 0:x.prefix)+""+ie.toFixed(2)})]})]})})]})]})]})}})}),(0,R.jsx)(t.Ay,{item:!0,xs:12,children:(0,R.jsxs)(d.A,{spacing:1,children:[(0,R.jsx)(o.A,{children:"Notes"}),(0,R.jsx)(c.A,{placeholder:"Address",rows:3,value:Z.notes,multiline:!0,name:"notes",onChange:E,inputProps:{maxLength:500},helperText:`${Z.notes.length} / 500`,sx:{width:"100%","& .MuiFormHelperText-root":{mr:0,display:"flex",justifyContent:"flex-end"}}})]})}),(0,R.jsx)(t.Ay,{item:!0,xs:12,sm:6,children:(0,R.jsxs)(d.A,{spacing:1,children:[(0,R.jsx)(o.A,{children:"Set Currency*"}),(0,R.jsx)(l.A,{sx:{width:{xs:"100%",sm:250}},children:(0,R.jsx)(b.A,{id:"country-select-demo",fullWidth:!0,options:n.countries,defaultValue:n.countries[2],value:n.countries.find((e=>{var i;return e.code===(null===(i=n.country)||void 0===i?void 0:i.code)})),onChange:(e,i)=>(0,V.PZ)(i),autoHighlight:!0,getOptionLabel:e=>e.label,renderOption:(e,i)=>(0,R.jsxs)(h.A,{component:"li",sx:{"& > img":{mr:2,flexShrink:0}},...e,children:[i.code&&(0,R.jsx)("img",{loading:"lazy",width:"20",src:`https://flagcdn.com/w20/${i.code.toLowerCase()}.png`,alt:"flag"}),i.label]}),renderInput:e=>{const i=n.countries.find((e=>{var i;return e.code===(null===(i=n.country)||void 0===i?void 0:i.code)}));return(0,R.jsx)(c.A,{...e,name:"phoneCode",placeholder:"Select",InputProps:{...e.InputProps,startAdornment:(0,R.jsx)(R.Fragment,{children:i&&""!==i.code&&(0,R.jsx)("img",{style:{marginRight:6},loading:"lazy",width:"20",src:`https://flagcdn.com/w20/${i.code.toLowerCase()}.png`,alt:"flag"})})},inputProps:{...e.inputProps,autoComplete:"new-password"}})}})})]})}),(0,R.jsx)(t.Ay,{item:!0,xs:12,sm:6,children:(0,R.jsxs)(d.A,{direction:"row",justifyContent:"flex-end",alignItems:"flex-end",spacing:2,sx:{height:"100%"},children:[(0,R.jsx)(j.A,{variant:"outlined",color:"secondary",disabled:""===Z.status||!G,sx:{color:"secondary.dark"},onClick:()=>(0,V.Nm)(!0),children:"Preview"}),(0,R.jsx)(j.A,{variant:"outlined",color:"secondary",sx:{color:"secondary.dark"},children:"Save"}),(0,R.jsx)(j.A,{color:"primary",variant:"contained",type:"submit",children:"Create & Send"}),(0,R.jsx)(B.A,{isOpen:n.isOpen,setIsOpen:e=>(0,V.Nm)(e),invoiceInfo:{...Z,subtotal:K,taxRate:X,discountRate:ee,total:ie},items:null===Z||void 0===Z?void 0:Z.invoice_detail,onAddNextInvoice:()=>(0,V.Nm)(!1)},Z.invoice_id)]})})]})})}})},E=()=>{const{invoice:e}=(0,V.hl)(),{invoiceMasterLoading:i,invoiceMaster:n}=(0,V.Be)(),s=i||void 0===n,r=(0,R.jsx)(h.A,{sx:{height:"calc(100vh - 310px)"},children:(0,R.jsx)(D.A,{})});let t=[{title:"Home",to:T.qm},{title:"Invoice",to:"/apps/invoice/dashboard"},{title:"Create Invoice"}];return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(P.A,{custom:!0,heading:"New Invoice",links:t}),(0,R.jsx)(S.A,{children:s?r:(0,R.jsx)(Y,{lists:e,invoiceMaster:n})})]})}},56921:(e,i,n)=>{n.d(i,{A:()=>s});const s=e=>{const i=e.toString();let n=null===i.match(/\d+/)?0:i.match(/\d+/)[0];const s=n.length;for(n=(parseInt(n)+1).toString();n.length<s;)n="0"+n;return i.replace(/[0-9]/g,"").concat(n)}}}]);